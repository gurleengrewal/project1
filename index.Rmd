---
title: 'Project 1: Wrangling, Exploration, Visualization'
author: "SDS322E"
date: '11/01/2021'
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
  pdf_document:
    toc: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", warning = F, message = F,
tidy=TRUE, tidy.opts=list(width.cutoff=60), R.options=list(max.print=100))
```

## Data Wrangling, Exploration, Visualization

### Gurleen Grewal, gkg422

#### 




```{R}
#
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("Ecdat")
install.packages("AER")
library(Ecdat)
library(AER)
library(tidyverse)
Fatalities <- read_csv("Fatalities.csv")
Fatality <- read_csv("Fatality.csv")

```

#### Tidying: Reshaping

If your datasets are tidy already, demonstrate that you can reshape data with pivot wider/longer here (e.g., untidy and then retidy). Alternatively, it may be easier to wait until the wrangling section so you can reshape your summary statistics. Note here if you are going to do this.

```{R}
# 
Fatalities = select(Fatalities, -c(state))

arrange(Fatalities, across(everything(), desc))

Fatality = select(Fatality, -c(state))

Fatalities %>% mutate(Fatalities, unrate = unemp ) %>% mutate(Fatalities, vmiles = miles) %>% mutate(Fatalities, jaild = jail) %>% mutate(Fatalities, mlda=drinkage) %>% mutate(Fatalities, comserd=service) %>% mutate(Fatalities, perinc = income)

arrange(Fatality, across(everything(), desc))

Fatalities %>% na.omit()

Fatality %>% na.omit()
```

    
#### Joining/Merging

```{R}
# 
anti_join(Fatalities, Fatality, by ="year") %>% summarize(n_distinct(year))

anti_join(Fatality, Fatalities, by ="year") %>% summarize(n_distinct(year))

inner_join(Fatalities, Fatality, by="year") %>% summarize(n_distinct(year))

full_join <- left_join(Fatality, Fatalities, by="year")

```

Discussions of joining here. Feel encouraged to break up into more than once code chunk and discuss each in turn.

####  Wrangling

```{R}
# 
full_join %>% group_by(year) %>% summarize(mean_miles = mean(miles), sd_miles = sd(miles), max_miles = max(miles), min_miles = min(miles), n())

full_join %>% group_by(year) %>% summarize(mean_unrate = mean(unrate), sd_unrate = sd(unrate), max_unrate = max(unrate), min_unrate = min(unrate), n())

full_join %>% group_by(year) %>% summarize(mean_mlda = mean(mlda), sd_mlda = sd(mlda), max_mlda = max(mlda), min_mlda = min(mlda), n())

full_join %>% group_by(year) %>% summarize(mean_perinc = mean(perinc), sd_perinc = sd(perinc), max_perinc = max(perinc), min_perinc = min(perinc), n())

```

Your discussion of wrangling section here. Feel encouraged to break up into more than once code chunk and discuss each in turn.


#### Visualizing

```{R}
# 
full_join %>% select(year, jaild, vmiles ) %>% na.omit %>%
  group_by(year, jaild) %>% summarize(mean=mean(vmiles),se=sd(vmiles)/sqrt(n())) %>% ggplot(aes(year,mean, fill=jaild))+geom_bar(stat="identity", position="dodge")+ geom_errorbar(aes(ymin=mean-se, ymax=mean+se), position="dodge") + coord_flip() +  ggtitle("Number of average miles per driver and mandatory jail time served  from 1982 to 1988")
```

Your discussion of plot 1

```{R}
# 
ggplot(full_join, aes(x=year, y=vmiles))+ geom_jitter(alpha=.8, aes(color=vmiles)) +geom_boxplot()+ ggtitle("Average miles driven per year by each driver")

```

Your discussion of plot 2

```{R}
# 
ggplot(data = full_join, aes(x = year, y = vmiles   ,color= jaild)) +
  geom_point(size = 1.5) + xlab("year")+geom_line()+ylab("vmiles")+ scale_color_manual(values = c("yes" = "black", "no" = "purple"))+
  ggtitle("Number of average miles per driver and mandatory jail time served  from 1982 to 1988 ")
```

Your discussion of plot 3

#### Concluding Remarks

If any!




